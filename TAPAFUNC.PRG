***********************************
** FUNCOES DO PROGRAMA  sirc.prg **
***********************************

***********************************
*** FUNCAO NOVO APTO            ***
***********************************
FUNCTION NOVOAPTO
PARA X
USE &SHAR41 INDEX &SHAR42
GOTO TOP
SEEK X
IF FOUND()
   CLOSE ALL
   RETURN(.F.)
ENDIF
CLOSE ALL
RETURN(.T.)

***********************************
***     FUNCAO TESTE DE BLOCO   ***
***********************************
FUNCTION TESTABLOCO
PARA X
IF EMPTY(X)
   RETURN(.F.)
ENDIF
X=ALLTRIM(X)
IF X="2368" .OR. X="64" .OR. X="88" .OR. X="44" .OR. X="GARAG" .OR. X="LOJAS"
   RETURN(.T.)
ENDIF
RETURN(.F.)

**********************************
*** FUNCAO "UDF" (ACHOICE)     ***
*** PERMITE FAZER O MENU RODAR ***
**********************************
FUNCTION tapaFUNCA(MODO,ELE,POS)

IF PROG=1
   CENTRA(23,XTIT[ELE])
ELSEIF PROG=2
   CENTRA(23,XDIG[ELE])
ELSEIF PROG=3
   CENTRA(23,XREL[ELE])
ELSEIF PROG=4
   CENTRA(23,XFIM[ELE])
ELSEIF PROG=5
   CENTRA(23,XCAD[ELE])
ENDIF
IF MODO=1
   KEYBOARD CHR(30)
ELSEIF MODO=2
   KEYBOARD CHR(31)
ELSEIF MODO=3
   IF LASTKEY()=27
      RETURN 0
   ELSEIF LASTKEY()=19
      KEYBOARD CHR(27)+CHR(19)+CHR(13)
   ELSEIF LASTKEY()=4
      KEYBOARD CHR(27)+CHR(4)+CHR(13)
   ELSEIF LASTKEY()=13
      A=ELE
      RETURN 1
   ENDIF
ENDIF
RETURN 2
******************************************************************



***********************************************
**** DIGITACAO DA OPCAO "TITULOS" (P/TODOS ****
***********************************************
FUNC TITULOS_BLOCO
@ 04,02 CLEAR TO 19,78
CENTRA(05,"DIGITACAO DOS TITULOS P/O BLOCO "+XBLOCO)
BORDA(04,05,19,75,setcolor())
USE &SHAR51 INDEX &SHAR52
GOTO TOP
SEEK XBLOCO
IF .NOT. FOUND()
   GOTO TOP
   APPE BLAN
   STORE SPACE(24) TO XTITULO1,XTITULO2,XTITULO3,XTITULO4,XTITULO5,XTITULO6,XTITULO7
ELSE
   XTITULO1=TITULO1
   XTITULO2=TITULO2
   XTITULO3=TITULO3
   XTITULO4=TITULO4
   XTITULO5=TITULO5
   XTITULO6=TITULO6
   XTITULO7=TITULO7
ENDIF

@ 09,15 SAY "TITULO 1....." GET XTITULO1
@ 10,15 SAY "TITULO 2....." GET XTITULO2
@ 11,15 SAY "TITULO 3....." GET XTITULO3
@ 12,15 SAY "TITULO 4....." GET XTITULO4
@ 13,15 SAY "TITULO 5....." GET XTITULO5
@ 14,15 SAY "TITULO 6....." GET XTITULO6
@ 15,15 SAY "TITULO 7....." GET XTITULO7

READ
IF LASTKEY()=27
   RETURN(.T.)
ENDIF

@ 17,10 SAY "CONFIRMA....?" GET SN PICT "@!"
READ

IF .NOT. SN="S"
   RETURN(.T.)
ENDIF

IF LASTKEY()=27
   RETURN(.T.)
   KEYB CHR(27)
ENDIF
IF FLOCK()
REPLACE BLOCO   WITH XBLOCO
REPLACE TITULO1 WITH XTITULO1
REPLACE TITULO2 WITH XTITULO2
REPLACE TITULO3 WITH XTITULO3
REPLACE TITULO4 WITH XTITULO4
REPLACE TITULO5 WITH XTITULO5
REPLACE TITULO6 WITH XTITULO6
REPLACE TITULO7 WITH XTITULO7
COMMIT
ELSE
AVISO("FLOCK - OUTRO USUARIO ATIVO")
ENDIF
KEYB CHR(27)
RETURN(.T.)
***********************************************
